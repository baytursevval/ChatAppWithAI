{"ast":null,"code":"var _jsxFileName = \"/home/sevo/Desktop/chat-web/src/components/Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport axios from \"axios\";\nimport \"./Chat.css\"; // CSS ayrı dosyada olacak\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Chat({\n  currentUser\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState(\"\");\n  const [users, setUsers] = useState([]);\n  const [receiverId, setReceiverId] = useState(\"\");\n  const messagesEndRef = useRef(null);\n  useEffect(() => {\n    axios.get(\"http://localhost:5285/api/user\").then(res => setUsers(res.data.filter(u => u.id !== currentUser.id))).catch(err => console.error(err));\n    fetchMessages();\n  }, []);\n  const fetchMessages = () => {\n    if (!receiverId) return;\n    axios.get(`http://localhost:5285/api/message?user1=${currentUser.id}&user2=${receiverId}`).then(res => setMessages(res.data)).catch(err => console.error(err));\n  };\n  const handleSend = () => {\n    if (!text || !receiverId) return;\n    const payload = {\n      text,\n      senderId: currentUser.id,\n      receiverId: parseInt(receiverId)\n    };\n    axios.post(\"http://localhost:5285/api/message\", payload).then(res => {\n      setText(\"\");\n      fetchMessages();\n    }).catch(err => console.error(err));\n  };\n  useEffect(() => {\n    fetchMessages();\n    const interval = setInterval(fetchMessages, 3000);\n    return () => clearInterval(interval);\n  }, [receiverId]);\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    // Scroll to bottom when messages update\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [messages]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [\"Ho\\u015Fgeldin, \", currentUser.nickname]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      value: receiverId,\n      onChange: e => setReceiverId(e.target.value),\n      className: \"user-select\",\n      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"\",\n        children: \"Mesaj g\\xF6nderecek kullan\\u0131c\\u0131y\\u0131 se\\xE7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), users.map(u => /*#__PURE__*/_jsxDEV(\"option\", {\n        value: u.id,\n        children: u.nickname\n      }, u.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-container\",\n      children: [messages.map(m => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `message ${m.senderId === currentUser.id ? \"sent\" : \"received\"}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-text\",\n          children: m.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-meta\",\n          children: [m.sentiment, \" (\", m.score.toFixed(2), \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 13\n        }, this)]\n      }, m.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"send-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: text,\n        onChange: e => setText(e.target.value),\n        placeholder: \"Mesaj yaz...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSend,\n        children: \"G\\xF6nder\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"nvcJaeZ0wJcLVLHTkj9kDGh6FxQ=\");\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","jsxDEV","_jsxDEV","Chat","currentUser","_s","messages","setMessages","text","setText","users","setUsers","receiverId","setReceiverId","messagesEndRef","get","then","res","data","filter","u","id","catch","err","console","error","fetchMessages","handleSend","payload","senderId","parseInt","post","interval","setInterval","clearInterval","_messagesEndRef$curre","current","scrollIntoView","behavior","className","children","nickname","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","e","target","map","m","sentiment","score","toFixed","ref","type","placeholder","onClick","_c","$RefreshReg$"],"sources":["/home/sevo/Desktop/chat-web/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport axios from \"axios\";\nimport \"./Chat.css\"; // CSS ayrı dosyada olacak\n\nfunction Chat({ currentUser }) {\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState(\"\");\n  const [users, setUsers] = useState([]);\n  const [receiverId, setReceiverId] = useState(\"\");\n  const messagesEndRef = useRef(null);\n\n  useEffect(() => {\n    axios.get(\"http://localhost:5285/api/user\")\n      .then(res => setUsers(res.data.filter(u => u.id !== currentUser.id)))\n      .catch(err => console.error(err));\n\n    fetchMessages();\n  }, []);\n\n  const fetchMessages = () => {\n    if (!receiverId) return;\n\n    axios.get(`http://localhost:5285/api/message?user1=${currentUser.id}&user2=${receiverId}`)\n      .then(res => setMessages(res.data))\n      .catch(err => console.error(err));\n  };\n\n  const handleSend = () => {\n    if (!text || !receiverId) return;\n\n    const payload = {\n      text,\n      senderId: currentUser.id,\n      receiverId: parseInt(receiverId)\n    };\n\n    axios.post(\"http://localhost:5285/api/message\", payload)\n      .then(res => {\n        setText(\"\");\n        fetchMessages();\n      })\n      .catch(err => console.error(err));\n  };\n\n  useEffect(() => {\n    fetchMessages();\n    const interval = setInterval(fetchMessages, 3000);\n    return () => clearInterval(interval);\n  }, [receiverId]);\n\n  useEffect(() => {\n    // Scroll to bottom when messages update\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  return (\n    <div className=\"chat-container\">\n      <h3>Hoşgeldin, {currentUser.nickname}</h3>\n\n      <select \n        value={receiverId} \n        onChange={e => setReceiverId(e.target.value)}\n        className=\"user-select\"\n      >\n        <option value=\"\">Mesaj gönderecek kullanıcıyı seç</option>\n        {users.map(u => (\n          <option key={u.id} value={u.id}>{u.nickname}</option>\n        ))}\n      </select>\n\n      <div className=\"messages-container\">\n        {messages.map(m => (\n          <div \n            key={m.id} \n            className={`message ${m.senderId === currentUser.id ? \"sent\" : \"received\"}`}\n          >\n            <div className=\"message-text\">{m.text}</div>\n            <div className=\"message-meta\">\n              {m.sentiment} ({m.score.toFixed(2)})\n            </div>\n          </div>\n        ))}\n        <div ref={messagesEndRef} />\n      </div>\n\n      <div className=\"send-container\">\n        <input\n          type=\"text\"\n          value={text}\n          onChange={e => setText(e.target.value)}\n          placeholder=\"Mesaj yaz...\"\n        />\n        <button onClick={handleSend}>Gönder</button>\n      </div>\n    </div>\n  );\n}\n\nexport default Chat;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}